import{r as X}from"./request-BBm029un.js";import{f as Z,g as ee,h as te}from"./index-CWriyH3k.js";import{d as ae,a as i,o as le,c as p,e as h,f as s,g as l,w as o,y as oe,F as y,i as r,q as V,s as N,k as w,v as f,p as ne,l as se}from"./index-3eeMgXGn.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./axios-B4uVmeYG.js";const ie=(b,C,T)=>X.post(`/pms/taskFeedback/list?projectName=${b}&userId=${C}&feedbackTime=${T}`),P=b=>(ne("data-v-336a3822"),b=b(),se(),b),de={class:"disFlex"},ue={class:"marginTop15px marginRight20 borderRadius5"},ce=P(()=>s("span",{class:"common-top-text"},"项目：",-1)),pe={class:"marginTop15px marginRight20 borderRadius5"},me=P(()=>s("span",{class:"common-top-text"},"处理人：",-1)),ge={class:"el-dropdown-link"},_e={class:"bgf4"},ve={class:"marginTop15px marginRight20 borderRadius5"},fe=P(()=>s("span",{class:"common-top-text"},"反馈时间：",-1)),be=P(()=>s("div",{class:"marginTop30"},[s("span",{class:"font16 color666"},"反馈看板")],-1)),he={class:"marginTop15px"},we={class:"page"},ke={class:"list-pnoSpan"},Se={class:"list-pagesize"},xe=ae({__name:"index",setup(b){let C=i([]);const T=i(),I=i(),R=i(""),$=i(""),j=i(""),M=i(""),A=i(),m=i({currentPage:1,pageSize:0,totalPage:0,totalResult:0}),g=i([]),z=i([]),k=i([]);le(()=>{_()});const U=n=>{console.log(`${n} items per page`)},L=()=>{_()},_=async()=>{const n=$.value==""?"":G($.value),t=n=="1970-01-01 08:00:00"?"":n;let a=await ie(R.value,z.value,t);a.code==0&&(C.value=a.feedbacklist,m.value=a.pageInfo);let d=await Z();d.code==0&&(A.value=d.projectNames);let u=await ee();u.code==0&&(T.value=u.roleList)},H=n=>{const t={userid:Number(n.userid),truename:String(n.truename)};g.value.some(a=>a.userid===t.userid)||g.value.push(t),z.value=g.value.map(a=>String(a.userid)),k.value=g.value.map(a=>String(a.truename))},q=n=>{const t=g.value.findIndex(a=>a.userid===n);t!==-1&&(g.value.splice(t,1),z.value=g.value.map(a=>String(a.userid)),k.value.splice(t,1))},Y=()=>k.value&&k.value.length===0?"请选择":k.value,E=async n=>{let t=await te(n);t&&(I.value=t.adminList)},B=(n,t)=>{var a=new Date(n),d=a.getFullYear(),u=a.getMonth()+1,v=a.getDate();return a.getHours(),a.getMinutes(),a.getSeconds(),n?d+"-"+(u.toString().length>1?u:"0"+u)+"-"+(v.toString().length>1?v:"0"+v):""},G=n=>{const t=new Date(n),a=t.getFullYear(),d=String(t.getMonth()+1).padStart(2,"0"),u=String(t.getDate()).padStart(2,"0"),v=String(t.getHours()).padStart(2,"0"),S=String(t.getMinutes()).padStart(2,"0"),x=String(t.getSeconds()).padStart(2,"0");return`${a}-${d}-${u} ${v}:${S}:${x}`};return(n,t)=>{const a=r("el-option"),d=r("el-select"),u=r("arrow-down"),v=r("el-icon"),S=r("el-button"),x=r("el-form-item"),F=r("el-row"),J=r("el-form"),K=r("el-dropdown"),O=r("el-date-picker"),c=r("el-table-column"),Q=r("el-table"),W=r("el-pagination");return p(),h(y,null,[s("div",de,[s("div",ue,[ce,l(d,{class:"width180",modelValue:R.value,"onUpdate:modelValue":t[1]||(t[1]=e=>R.value=e),clearable:"",onClear:t[2]||(t[2]=e=>_())},{default:o(()=>[(p(!0),h(y,null,V(A.value,e=>(p(),N(a,{key:e.id,label:e.projectName,value:e.projectName,onClick:t[0]||(t[0]=D=>_())},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),s("div",pe,[me,l(K,{trigger:"click"},{dropdown:o(()=>[l(J,{"label-width":"120px",class:"margin20 paddingbottom200"},{default:o(()=>[l(F,null,{default:o(()=>[l(x,{label:"角色：",class:"marginBottom20"},{default:o(()=>[l(d,{class:"width180",modelValue:j.value,"onUpdate:modelValue":t[3]||(t[3]=e=>j.value=e),teleported:!1,clearable:""},{default:o(()=>[(p(!0),h(y,null,V(T.value,e=>(p(),N(a,{onClick:D=>E(e.roleid),key:e.roleid,label:e.rolename,value:e.roleid},null,8,["onClick","label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(x,{label:"账号："},{default:o(()=>[l(d,{class:"width180",modelValue:M.value,"onUpdate:modelValue":t[4]||(t[4]=e=>M.value=e),teleported:!1,clearable:""},{default:o(()=>[(p(!0),h(y,null,V(I.value,e=>(p(),N(a,{key:e.userid,label:e.truename,value:e.userid,onClick:D=>(H(e),_())},null,8,["label","value","onClick"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(x,{label:"已选人员：",class:"marginTop15px"},{default:o(()=>[(p(!0),h(y,null,V(g.value,e=>(p(),h("div",{key:e.userid},[s("span",_e,[w(f(e.truename)+" ",1),l(S,{onClick:D=>(q(e.userid),_()),size:"small",circle:"",round:"",type:"primary",icon:"Minus"},null,8,["onClick"])])]))),128))]),_:1})]),_:1})]),default:o(()=>[s("span",ge,[l(S,{class:"borGray_fontBlack width120",size:"small"},{default:o(()=>[w(f(Y())+" ",1),l(v,{class:"el-icon--right"},{default:o(()=>[l(u)]),_:1})]),_:1})])]),_:1})]),s("div",ve,[fe,l(O,{modelValue:$.value,"onUpdate:modelValue":t[5]||(t[5]=e=>$.value=e),type:"date",placeholder:"请选择",onChange:t[6]||(t[6]=e=>_())},null,8,["modelValue"])])]),be,s("div",he,[l(Q,{data:oe(C),"header-row-class-name":"table-header",class:"marginTop15px"},{default:o(()=>[l(c,{label:"序号",type:"index",width:"120",align:"center"}),l(c,{prop:"projectName",label:"项目名称",width:"120",align:"center"}),l(c,{prop:"taskName",label:"任务名称",width:"180",align:"center"}),l(c,{prop:"endTime",label:"结束日期",width:"180",align:"center"},{default:o(({row:e})=>[w(f(e.endTime==="2099-12-31 00:00:00"?"长期项目":B(e.endTime,"a")),1)]),_:1}),l(c,{prop:"performanceHours",label:"绩效工时",width:"120",align:"center"}),l(c,{prop:"handlePeople",label:"处理人",width:"120",align:"center"}),l(c,{prop:"feedbackRecordTime",label:"反馈时间",width:"120",align:"center"},{default:o(({row:e})=>[w(f(B(e.feedbackRecordTime,"a")),1)]),_:1}),l(c,{prop:"feedbackMinute",label:"反馈工时",width:"120",align:"center"},{default:o(({row:e})=>[w(f(e.feedbackMinute?(e.feedbackMinute/60).toFixed(1):0),1)]),_:1}),l(c,{prop:"progressDesc",label:"反馈内容",align:"center"})]),_:1},8,["data"]),s("div",we,[l(W,{"current-page":m.value.currentPage,"onUpdate:currentPage":t[7]||(t[7]=e=>m.value.currentPage=e),"page-size":m.value.pageSize,"onUpdate:pageSize":t[8]||(t[8]=e=>m.value.pageSize=e),layout:"prev,next,slot,jumper",total:m.value.totalResult,onSizeChange:U,onCurrentChange:L},{default:o(()=>[s("span",ke,[s("span",Se,"第"+f(m.value.currentPage)+" / "+f(m.value.totalPage)+"页",1)])]),_:1},8,["current-page","page-size","total"]),l(S,{size:"small",class:"list-pagepno"},{default:o(()=>[w("跳转")]),_:1})])])],64)}}}),Pe=re(xe,[["__scopeId","data-v-336a3822"]]);export{Pe as default};
